//============================================================================
// Name        : occi_batch_insert.cpp
// Author      : LIRUIJIE
// Version     :
// Copyright   : Your copyright notice
// Description : Hello World in C++, Ansi-style
//============================================================================

#include <iostream>
using namespace std;
using namespace oracle::occi;
int main() {
	cout << "!!!Hello World!!!" << endl; // prints !!!Hello World!!!
	while(1)
	{
	 try
		{
		   const string userName = "busp";
		   const string password = "busp";
		   const string connectString= "192.168.1.81";

		   // cout <<"name = " << oracle_username     <<"   oracle_password = " <<  oracle_password <<        "   oracle_connectstring = " << oracle_connectstring << endl;
		   cout <<"name = " << userName    <<"  oracle_password = " <<  password <<        "    oracle_connectstring = " << connectString << endl;
		   unsigned int maxConn=1000;
		   unsigned int minConn=5;
		   unsigned int incrConn=2;

			string sql;

		   OraEnviroment = oracle::occi::Environment::createEnvironment("UTF8","UTF8");
		   pConnPool= OraEnviroment->createStatelessConnectionPool(userName,password,connectString,maxConn,minConn,incrConn);

			if(pConnPool)
				  {
				 pConnPool->setTimeOut(10);
				 conn=pConnPool->getConnection();
				 if(conn)
						 {
								 stmt = conn->createStatement();
								 stmt->setAutoCommit(true);
								 cout << "Connect oracle"<<endl;
								 return true;
						 }
				  }
		}
	 catch (SQLException &sqlExcp)
		{
		   sqlExcp.getErrorCode();
		   string strinfo=sqlExcp.getMessage();
		   cout<<strinfo;
		   return false;
		}
		printf("oracle open fail\n");
		sleep(1);
	}
}
